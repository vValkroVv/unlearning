# @package _global_

defaults:
  - override /model: Llama-3.2-1B-Instruct-lora
  - override /trainer: UNDIAL
  - override /data: unlearn
  - override /data/datasets@data.forget: MUSE_forget
  - override /data/datasets@data.retain: MUSE_retain
  - override /eval: muse

data_split: News
forget_split: forget
retain_split: retain1
retain_logs_path: null

model:
  model_args:
    pretrained_model_name_or_path: meta-llama/Llama-3.2-1B-Instruct

data:
  anchor: forget
  forget:
    MUSE_forget:
      args:
        hf_args:
          path: muse-bench/MUSE-${data_split}
          split: ${forget_split}
  retain:
    MUSE_retain:
      args:
        hf_args:
          path: muse-bench/MUSE-${data_split}
          split: ${retain_split}

eval:
  muse:
    data_split: ${data_split}
    retain_logs_path: ${retain_logs_path}
    overwrite: true

trainer:
  args:
    per_device_train_batch_size: 1
    gradient_accumulation_steps: 32
    learning_rate: 1e-4
    num_train_epochs: 5
    lr_scheduler_type: constant
    warmup_ratio: 0.1
    logging_steps: 10
    eval_strategy: "no"
    save_strategy: "no"
    do_eval: false
    eval_on_start: false
    remove_unused_columns: false
    gradient_checkpointing: true
    ddp_find_unused_parameters: false
  method_args:
    beta: 3
    gamma: 1.0
    alpha: 0.1
    retain_loss_type: NLL

task_name: muse_undial_lora
